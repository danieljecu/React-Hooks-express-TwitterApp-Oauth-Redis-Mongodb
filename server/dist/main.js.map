{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./Model/Message.js","webpack:///./Repo/TweetRepo.js","webpack:///./app.js","webpack:///./routes/login.js","webpack:///./routes/messageBoard.js","webpack:///./routes/tweet.js","webpack:///./utils/AuthTool.js","webpack:///./utils/MongoConnect.js","webpack:///./utils/RedisConnect.js","webpack:///external \"@babel/polyfill\"","webpack:///external \"bluebird\"","webpack:///external \"cors\"","webpack:///external \"dotenv\"","webpack:///external \"express\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"moment\"","webpack:///external \"mongoose\"","webpack:///external \"redis\"","webpack:///external \"request\""],"names":["mongoose","require","Scheme","Schema","MessageSchema","user","type","String","topic","required","content","date","Date","now","Message","model","module","exports","request","config","getAllUserTweet","accessObj","searchContent","url","getOperation","getTweetByKeyword","getFavoriteList","screen_name","notFavorite","favoritedList","Promise","resolve","reject","get","oauth","token","access_token","token_secret","access_secret","consumer_key","process","env","CONSUMER_KEY","consumer_secret","CONSUMER_SECRET","err","r","body","JSON","parse","error","console","reduce","pre","temp","name","text","statuses","tweet_id","id_str","favorited","postTweet","tweet","simpleReturn","changeFavorite","id","status","post","log","errors","express","app","radisStore","authTool","use","json","cors","PORT","listen","router","Router","jwt","req","res","oauth_callback","send","message","jsonStr","replace","oauthToken","form","oauth_verifier","verifier","headers","bodyString","parsedBody","redis","set","user_id","stringify","oauth_token","oauth_token_secret","expire","AUTH_TIME","sign","JWT_SECRET","expiresIn","moment","result","access","then","messageData","subject","create","e","sendStatus","aggregate","$facet","getData","$match","$sort","$skip","skip","$limit","limit","totalCount","$group","_id","count","$sum","arr","map","i","format","serachInput","nowStatus","client","createClient","port","REDIS_PORT","host","REDIS_HOST","password","REDIS_PASSWORD","next","decoded","verify","promise","bluebird","connect","MONGO_DB","useNewUrlParser","redisStore"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const mongoose = require(\"mongoose\");\r\nconst Scheme = mongoose.Schema;\r\n\r\nconst MessageSchema = new Scheme({\r\n  user: {\r\n    type: String\r\n  },\r\n\r\n  topic: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  content: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  date: {\r\n    type: Date,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\nconst Message = mongoose.model(\"4mationDiscussboard\", MessageSchema);\r\nmodule.exports = Message;\r\n","const request = require(\"request\");\r\nrequire(\"dotenv\").config();\r\nconst getAllUserTweet = (accessObj, searchContent) => {\r\n  const url = `https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=${searchContent}&count=200`;\r\n  return getOperation(accessObj, url, true);\r\n};\r\n\r\nconst getTweetByKeyword = (accessObj, searchContent) => {\r\n  const url = `https://api.twitter.com/1.1/search/tweets.json?q=${searchContent}&result_type=mixed&count=100`;\r\n  return getOperation(accessObj, url);\r\n};\r\n\r\nconst getFavoriteList = accessObj => {\r\n  const url = `https://api.twitter.com/1.1/favorites/list.json?count=200&screen_name=${\r\n    accessObj.screen_name\r\n  }`;\r\n  return getOperation(accessObj, url, false, true);\r\n};\r\nfunction getOperation(accessObj, url, notFavorite, favoritedList) {\r\n  return new Promise((resolve, reject) => {\r\n    request.get(\r\n      {\r\n        url: url,\r\n        oauth: {\r\n          token: accessObj.access_token,\r\n          token_secret: accessObj.access_secret,\r\n          consumer_key: process.env.CONSUMER_KEY,\r\n          consumer_secret: process.env.CONSUMER_SECRET\r\n        }\r\n      },\r\n\r\n      function(err, r, body) {\r\n        if (err || JSON.parse(body).error) {\r\n          reject(err => {\r\n            console.error(\"server error \" + err);\r\n          });\r\n          return;\r\n        }\r\n        if (notFavorite) {\r\n          resolve(\r\n            JSON.parse(body).reduce((pre, now) => {\r\n              let temp = {\r\n                name: now.user.name,\r\n                [\"Scree Name\"]: now.user.screen_name,\r\n                text: now.text\r\n              };\r\n              pre = [...pre, temp];\r\n              return pre;\r\n            }, [])\r\n          );\r\n        } else {\r\n          const temp = favoritedList\r\n            ? JSON.parse(body)\r\n            : JSON.parse(body).statuses;\r\n          resolve(\r\n            temp.reduce((pre, now) => {\r\n              let temp = {\r\n                tweet_id: now.id_str,\r\n                text: now.text,\r\n                name: now.user.name,\r\n                [\"Scree Name\"]: now.user.screen_name,\r\n                favorited: now.favorited\r\n              };\r\n              pre = [...pre, temp];\r\n              return pre;\r\n            }, [])\r\n          );\r\n        }\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nconst postTweet = (accessObj, tweet) => {\r\n  const url = `https://api.twitter.com/1.1/statuses/update.json?status=${tweet}`;\r\n  return simpleReturn(accessObj, url);\r\n};\r\nconst changeFavorite = (accessObj, id, status) => {\r\n  const url = status\r\n    ? `https://api.twitter.com/1.1/favorites/destroy.json?id=${id}`\r\n    : `https://api.twitter.com/1.1/favorites/create.json?id=${id}`;\r\n\r\n  return simpleReturn(accessObj, url);\r\n};\r\nfunction simpleReturn(accessObj, url) {\r\n  return new Promise((resolve, reject) => {\r\n    request.post(\r\n      {\r\n        url: url,\r\n        oauth: {\r\n          token: accessObj.access_token,\r\n          token_secret: accessObj.access_secret,\r\n          consumer_key: process.env.CONSUMER_KEY,\r\n          consumer_secret: process.env.CONSUMER_SECRET\r\n        }\r\n      },\r\n\r\n      function(err, r, body) {\r\n        console.log(\" get post\");\r\n        if (err || JSON.parse(body).errors) {\r\n          reject(() => {\r\n            console.error(\"server error\");\r\n          });\r\n          return;\r\n        }\r\n        resolve(\"200 OK\");\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  getAllUserTweet,\r\n  postTweet,\r\n  getTweetByKeyword,\r\n  changeFavorite,\r\n  getFavoriteList\r\n};\r\n","const express = require(\"express\");\r\nconst app = express();\r\nconst radisStore = require(\"./utils/RedisConnect\");\r\nconst authTool = require(\"./utils/AuthTool\");\r\napp.use(express.json());\r\n\r\nvar cors = require(\"cors\");\r\n\r\napp.use(cors());\r\n\r\napp.use(\"/auth\", radisStore, require(\"./routes/login\"));\r\napp.use(\"/tweet\", authTool, require(\"./routes/tweet\"));\r\napp.use(\"/message\", authTool, require(\"./routes/messageBoard\"));\r\n\r\nconst PORT = process.env.PORT || 5000;\r\n\r\napp.listen(PORT, () => {\r\n  console.log(`server started at ${PORT}`);\r\n  require(\"./utils/MongoConnect\");\r\n});\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst cors = require(\"cors\");\r\nconst request = require(\"request\");\r\nconst jwt = require(\"jsonwebtoken\");\r\n\r\nrequire(\"dotenv\").config();\r\nrouter.use(cors());\r\n\r\nrouter.get(\"/login/request_token\", (req, res) => {\r\n  request.post(\r\n    {\r\n      url: \"https://api.twitter.com/oauth/request_token\",\r\n      oauth: {\r\n        oauth_callback: \"http://localhost:3000/loading\",\r\n        consumer_key: process.env.CONSUMER_KEY,\r\n        consumer_secret: process.env.CONSUMER_SECRET\r\n      }\r\n    },\r\n    function(err, r, body) {\r\n      if (err) {\r\n        return res.send(500, { message: err.message });\r\n      }\r\n\r\n      var jsonStr =\r\n        '{ \"' + body.replace(/&/g, '\", \"').replace(/=/g, '\": \"') + '\"}';\r\n      res.send(JSON.parse(jsonStr));\r\n    }\r\n  );\r\n});\r\n\r\nrouter.post(\"/login/get_token\", (req, res) => {\r\n  request.post(\r\n    {\r\n      url: `https://api.twitter.com/oauth/access_token`,\r\n      oauth: {\r\n        consumer_key: process.env.CONSUMER_KEY,\r\n        consumer_secret: process.env.CONSUMER_SECRET,\r\n        token: req.body.oauthToken\r\n      },\r\n      form: { oauth_verifier: req.body.verifier },\r\n      headers: {\r\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n      }\r\n    },\r\n    function(err, r, body) {\r\n      if (err) {\r\n        return res.send(500, { message: err.message });\r\n      }\r\n\r\n      const bodyString =\r\n        '{ \"' + body.replace(/&/g, '\", \"').replace(/=/g, '\": \"') + '\"}';\r\n      const parsedBody = JSON.parse(bodyString);\r\n\r\n      req.redis.set(\r\n        parsedBody.user_id,\r\n        JSON.stringify({\r\n          screen_name: parsedBody.screen_name,\r\n          user_id: parsedBody.user_id,\r\n          access_token: parsedBody.oauth_token,\r\n          access_secret: parsedBody.oauth_token_secret\r\n        }),\r\n        err => {\r\n          if (err) {\r\n            console.error(\"err: \", err);\r\n          }\r\n        }\r\n      );\r\n\r\n      req.redis.expire(parsedBody.user_id, process.env.AUTH_TIME, err => {\r\n        if (err) {\r\n          console.error(\"err: \", err);\r\n        }\r\n      });\r\n\r\n      let token = jwt.sign(\r\n        { user_id: parsedBody.user_id },\r\n        process.env.JWT_SECRET,\r\n        {\r\n          expiresIn: \"1h\"\r\n        }\r\n      );\r\n\r\n      res.send({\r\n        jwt: token,\r\n        screen_name: parsedBody.screen_name\r\n      });\r\n    }\r\n  );\r\n});\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst cors = require(\"cors\");\r\nconst Message = require(\"../Model/Message\");\r\nconst moment = require(\"moment\");\r\n\r\nrequire(\"dotenv\").config();\r\nrouter.use(cors());\r\n\r\nrouter.post(\"/add_new_message\", async (req, res) => {\r\n  const result = req.access;\r\n  result\r\n    .then(() => {\r\n      const messageData = {\r\n        user: req.body.user,\r\n        topic: req.body.subject,\r\n        content: req.body.content,\r\n        date: new Date()\r\n      };\r\n      Message.create(messageData)\r\n        .then(() => res.send(\"200 OK\"))\r\n        .catch(e => res.sendStatus(e));\r\n    })\r\n    .catch(e => {\r\n      res.sendStatus(e);\r\n    });\r\n});\r\nrouter.post(\"/get_message\", async (req, res) => {\r\n  const result = req.access;\r\n  result\r\n    .then(() => {\r\n      Message.aggregate([\r\n        {\r\n          $facet: {\r\n            getData: [\r\n              { $match: {} },\r\n              { $sort: { date: -1 } },\r\n              { $skip: req.body.skip },\r\n              { $limit: req.body.limit }\r\n            ],\r\n            totalCount: [\r\n              {\r\n                $group: {\r\n                  _id: null,\r\n                  count: { $sum: 1 }\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      ])\r\n        .then(arr => {\r\n          let temp = arr[0].getData;\r\n          temp.map(i => {\r\n            i.date = moment(i.date).format(\"MMMM Do YYYY, h:mm:ss a\");\r\n          });\r\n\r\n          res.send({\r\n            result: temp,\r\n            count: arr[0].totalCount[0]\r\n          });\r\n        })\r\n        .catch(e => {\r\n          res.sendStatus(e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      res.sendStatus(e);\r\n    });\r\n});\r\n\r\nmodule.exports = router;\r\n","const express = require(\"express\");\r\nconst router = express.Router();\r\nconst cors = require(\"cors\");\r\n\r\nconst {\r\n  getAllUserTweet,\r\n  postTweet,\r\n  getTweetByKeyword,\r\n  changeFavorite,\r\n  getFavoriteList\r\n} = require(\"../Repo/TweetRepo\");\r\n\r\nrequire(\"dotenv\").config();\r\nrouter.use(cors());\r\n\r\nrouter.post(\"/tweet_by_user\", async (req, res) => {\r\n  const result = req.access;\r\n  result\r\n    .then(temp => {\r\n      getAllUserTweet(JSON.parse(temp), req.body.serachInput)\r\n        .then(temp => {\r\n          res.send(temp);\r\n        })\r\n        .catch(e => {\r\n          res.sendStatus(e);\r\n          res.send(\"error1   +++++\" + e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      res.sendStatus(e);\r\n      res.send(\"error1   +++++\" + e);\r\n    });\r\n});\r\nrouter.post(\"/tweet_post_new\", async (req, res) => {\r\n  const result = req.access;\r\n  result\r\n    .then(temp => {\r\n      postTweet(JSON.parse(temp), req.body.content)\r\n        .then(() => {\r\n          res.status(200);\r\n          res.send(\"OK\");\r\n        })\r\n        .catch(e => {\r\n          res.sendStatus(e);\r\n          res.send(\"error1   +++++\" + e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      res.sendStatus(e);\r\n      res.send(\"error1   +++++\" + e);\r\n    });\r\n});\r\nrouter.post(\"/tweet_by_keyword\", async (req, res) => {\r\n  console.log(\"/tweet_by_keyword\");\r\n  const result = req.access;\r\n  result\r\n    .then(temp => {\r\n      getTweetByKeyword(JSON.parse(temp), req.body.serachInput)\r\n        .then(temp => {\r\n          res.send(temp);\r\n        })\r\n        .catch(e => {\r\n          console.log(\"e cathch inside\");\r\n          res.sendStatus(e);\r\n          res.send(\"error1   +++++\" + e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      console.log(\"e cathch outside\");\r\n      res.sendStatus(e);\r\n      res.send(\"error1   +++++\" + e);\r\n    });\r\n});\r\nrouter.post(\"/tweet_favorite\", async (req, res) => {\r\n  const result = req.access;\r\n  console.log(req.body.id);\r\n  result\r\n    .then(temp => {\r\n      changeFavorite(JSON.parse(temp), req.body.id, req.body.nowStatus)\r\n        .then(temp => {\r\n          res.send(temp);\r\n        })\r\n        .catch(e => {\r\n          console.log(\"e cathch inside\");\r\n          res.sendStatus(e);\r\n          res.send(\"error1   +++++\" + e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      console.log(\"e cathch outside\");\r\n      res.sendStatus(e);\r\n      res.send(\"error1   +++++\" + e);\r\n    });\r\n});\r\nrouter.get(\"/tweet_favorite_list\", async (req, res) => {\r\n  console.log(\"/tweet_favorite\");\r\n  const result = req.access;\r\n  result\r\n    .then(temp => {\r\n      getFavoriteList(JSON.parse(temp))\r\n        .then(temp => {\r\n          res.send(temp);\r\n        })\r\n        .catch(e => {\r\n          console.log(\"e cathch inside\");\r\n          res.sendStatus(e);\r\n          res.send(\"error1   +++++\" + e);\r\n        });\r\n    })\r\n    .catch(e => {\r\n      console.log(\"e cathch outside\");\r\n      res.sendStatus(e);\r\n      res.send(\"error1   +++++\" + e);\r\n    });\r\n});\r\nmodule.exports = router;\r\n","const redis = require(\"redis\");\r\nrequire(\"dotenv\").config();\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst client = redis.createClient({\r\n  port: process.env.REDIS_PORT,\r\n  host: process.env.REDIS_HOST,\r\n  password: process.env.REDIS_PASSWORD\r\n});\r\nconst authTool = (req, res, next) => {\r\n  let decoded = jwt.verify(\r\n    req.headers[\"authorization\"],\r\n    process.env.JWT_SECRET,\r\n    function(err, decoded) {\r\n      if (err) {\r\n        res.status(401);\r\n        res.send(\"error1   +++++\" + err);\r\n        return;\r\n      }\r\n\r\n      if (!decoded) res.status(401);\r\n      return decoded;\r\n    }\r\n  );\r\n\r\n  const promise = new Promise((resolve, reject) => {\r\n    console.log(\"redis mid start\");\r\n\r\n    client.get(decoded.user_id, function(err, r) {\r\n      console.log(\"redis processing\");\r\n      if (err) {\r\n        reject(401);\r\n        res.status(401);\r\n        res.send(\"error1   +++++\" + err);\r\n      }\r\n\r\n      if (r) {\r\n        console.log(\"redis mid end\");\r\n        resolve(r);\r\n      } else {\r\n        reject(401);\r\n      }\r\n    });\r\n\r\n    // req.redis.end(true);\r\n  });\r\n  req.access = promise;\r\n\r\n  next();\r\n};\r\n\r\nmodule.exports = authTool;\r\n","const mongoose = require(\"mongoose\");\r\nconst bluebird = require(\"bluebird\");\r\nrequire(\"dotenv\").config(); // to read value of process.env.MongoURI\r\n\r\n// Get Mongoose to use the bluebird promise library\r\nmongoose.Promise = bluebird;\r\n\r\nmongoose\r\n  .connect(process.env.MONGO_DB, { useNewUrlParser: true })\r\n  .then(() => console.log(\"Mongodb connected\"))\r\n  .catch(err => console.log(err));\r\n\r\nmodule.exports = mongoose;\r\n","const redis = require(\"redis\");\r\nrequire(\"dotenv\").config();\r\nconst client = redis.createClient({\r\n  port: process.env.REDIS_PORT,\r\n  host: process.env.REDIS_HOST,\r\n  password: process.env.REDIS_PASSWORD\r\n});\r\nconst redisStore = (req, res, next) => {\r\n  req.redis = client;\r\n\r\n  next();\r\n};\r\n\r\nmodule.exports = redisStore;\r\n","module.exports = require(\"@babel/polyfill\");","module.exports = require(\"bluebird\");","module.exports = require(\"cors\");","module.exports = require(\"dotenv\");","module.exports = require(\"express\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"moment\");","module.exports = require(\"mongoose\");","module.exports = require(\"redis\");","module.exports = require(\"request\");"],"sourceRoot":""}